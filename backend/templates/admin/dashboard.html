{% extends "base.html" %}
{% block content %}
<h2 class="section-title">Dashboard</h2>
<div class="metric-grid">
  <div class="metric">
    <div class="label">Total Users</div>
    <div class="value">{{ stats.total_users }}</div>
  </div>
  <div class="metric">
    <div class="label">Active Premium</div>
    <div class="value">{{ stats.active_premium }}</div>
  </div>
  <div class="metric">
    <div class="label">Expiring 1d</div>
    <div class="value">{{ stats.expiring_1d }}</div>
  </div>
  <div class="metric">
    <div class="label">Expiring 3d</div>
    <div class="value">{{ stats.expiring_3d }}</div>
  </div>
</div>

<div class="card">
  <h3>Cron</h3>
  <form action="/admin/cron" method="post">
    <button class="btn ok" type="submit">Run cron now</button>
    <span class="muted">(idempotent)</span>
  </form>
</div>


<div class="card">
  <h3>Performance</h3>
  <p class="muted">View last 24h accuracy, win rate, and P/L from served signals.</p>
  <a class="btn" href="/admin/performance">Open Performance Report</a>
  <span class="muted" style="margin-left:8px">(auto-evaluates unevaluated logs)</span>
  
</div>


<div class="card">
  <h3>SQLite DB (Download / Upload)</h3>
  <div class="row">
    <div class="col">
      <a class="btn" href="/admin/db/download">Download bot.db</a>
    </div>
    <div class="col">
      <form action="/admin/db/upload" method="post" enctype="multipart/form-data">
        <input type="file" name="file" accept=".db,.sqlite" required>
        <button class="btn warn" type="submit">Upload & Replace</button>
      </form>
    </div>
  </div>
  <div class="muted" style="margin-top:8px">Upload replaces local bot.db (backup .bak created).</div>
</div>
{% endblock %}
